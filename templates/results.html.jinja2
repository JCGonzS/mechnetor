<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PIV results</title>
  <!--
  Loading Icon
  <script type="text/javascript" charset="utf8" src="https://raw.github.com/HubSpot/pace/v0.5.3/pace.min.js"></script>
  <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/pace_atom.css') }}">
  -->

  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Allerta+Stencil|Staatliches|Roboto:400|Merriweather:300,400|Montserrat|Lato">
  <link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/qtip2/3.0.3/jquery.qtip.min.css"/>
  <!-- <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css"/> -->
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/1.5.6/css/buttons.dataTables.min.css"/>
  <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/jquery.dataTables.night.css') }}"/>
  <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/results_style.css') }}"/>
  <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/common.css') }}"/>

  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/qtip2/3.0.3/jquery.qtip.min.js"></script>
  <script type="text/javascript" src="{{ url_for('static',filename='js/cytoscape.js') }}"></script>
  <!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.7.3/cytoscape.min.js" integrity="sha256-RCxc6xvytHR63k+FdJp71P5pO+5rgFIOw4T+JZemBmA=" crossorigin="anonymous"></script> -->
  <script type="text/javascript" src="https://cdn.rawgit.com/cytoscape/cytoscape.js-qtip/2.7.1/cytoscape-qtip.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.min.js" integrity="sha256-FPJJt8nA+xL4RU6/gsriA8p8xAeLGatoyTjldvQKGdE=" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.2.0/jszip.min.js" integrity="sha256-VwkT6wiZwXUbi2b4BOR1i5hw43XMzVsP88kpesvRYfU=" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.57/pdfmake.min.js" integrity="sha256-8s2O+N1IIFZ/3uLADkpz++emTlVbAiI320n5vcyww8M=" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.57/vfs_fonts.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.6/js/dataTables.buttons.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.colVis.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.flash.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.html5.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.print.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
  <script type="text/javascript" src="{{ url_for('static',filename='js/graph_features.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static',filename='js/cytoscape-svg.js') }}"></script>

  <base target="_blank">
</head>

<body>

  <div id="main_container">
    <div class="header">
  		<div id="header-content">
        <div id="header-title">Protein Interaction Visualization</div>
  			<div id="navbar">
  				<ul>
  					<li><a href="/" class="home-link">Home</a></li>
  					<li><a href="/help" class="help-link">Help</a></li>
  					<li><a href="http://www.russelllab.org" class="russell-link">Russell Lab</a></li>
  				</ul>
  			</div>
  		</div>
  	</div>

    <div id="body">
      <div id="body_t1" class="row">
        <div class="col-sm-2">
          <div id="control_panel">
            <div id="control_panel_title">Toggle</div>

            <div>
              <fieldset>
                <!-- <label class="container">Coord
                  <input type="checkbox" id="coord" checked="checked">
                  <span class="checkmark"></span>
                </label><br> -->
                <label class="container">Protein Boxes
                  <input type="checkbox" id="toggle_box" checked="checked">
                  <span class="checkmark"></span>
                </label>
              </fieldset>
            </div>

            <hr>

            <div>
              <fieldset>
                <div>
                  <span style="font-size: 14px; font-weight: bold;">Regions</span>
                  <label class="container" style="display:inline;left: 10px;"> all
                    <input type="checkbox" id="toggle_all_ele">
                    <span class="checkmark"></span>
                  </label>
                </div><br>

                <label class="container">Domains
                  <input type="checkbox" id="toggle_doms" checked="checked">
                  <span class="checkmark"></span>
                </label></br>
                <label class="container">Linear Motifs
                  <input type="checkbox" id="toggle_elms">
                  <span class="checkmark"></span>
                </label></br>
                <label class="container">3D-structure template
                  <input type="checkbox" id="toggle_iprets">
                  <span class="checkmark"></span>
                </label>
              </fieldset>
            </div>

            <hr>

            <div>
              <fieldset>
                <div>
                  <span style="font-size: 14px; font-weight: bold;">Interactions</span>
                  <label class="container" style="display:inline;left: 10px;"> all
                    <input type="checkbox" id="toggle_all_int">
                    <span class="checkmark"></span>
                  </label>
                </div><br>
                <label class="container"><div style="color:#460dd4;">User Input
                  <input type="checkbox" id="toggle_user_int" checked="checked">
                  <span class="checkmark"></div>
                </label></br>
                <label class="container"><div style="color:#aab7b8;">Protein-Protein
                  <input type="checkbox" id="toggle_pp_int" checked="checked">
                  <span class="checkmark"></div>
                </label></br>
                <label class="container"><div style="color:#16a085;"> Domain-Domain (3did)
                  <input type="checkbox" id="toggle_dom_int">
                  <span class="checkmark"></div>
                </label></br>
                <label class="container"><div style="color:#d4ac0d;"> Domain-Domain (inferred)
                  <input type="checkbox" id="toggle_idom_int">
                  <span class="checkmark"></div>
                </label></br>
                <label class="container"><div style="color:#b95db9;"> ELM-Domain
                  <input type="checkbox" id="toggle_elmdom_int">
                  <span class="checkmark"></div>
                </label></br>
                <!-- <div class="form-check form-check-inline">
                  <input class="form-check-input" type="checkbox" id="toggle_lmd2_int">
                  <label class="form-check-label" for="toggle_lmd2_int"> LM(pred)-Protein (LMD2)</label>
                </div>
                </br> -->
                <label class="container">InterPreTS
                  <input type="checkbox" id="toggle_prets_int">
                  <span class="checkmark">
                </label>
              </fieldset>
            </div>

            <hr>

            <div>
              <fieldset>
                <div>
                  <span style="font-size: 14px; font-weight: bold;">Modifications</span>
                  <label class="container" style="display:inline;left: 10px;"> all
                    <input type="checkbox" id="toggle_all_mod">
                    <span class="checkmark"></span>
                  </label>
                </div><br>

                <label class="container"><div style="color:#FF0000;">User-input mutations
                  <input type="checkbox" id="toggle_input_mut">
                  <span class="checkmark"></div>
                </label></br>
                <label class="container"><div style="color:#28446f;">COSMIC mutations
                  <input type="checkbox" id="toggle_cosmic_mut">
                  <span class="checkmark"></div>
                </label></br>
                <label class="container"><div style="color:#FFFF00;">Phosphorylations
                  <input type="checkbox" id="toggle_phos">
                  <span class="checkmark"></div>
                </label></br>
                <label class="container"><div style="color:#008000;">Acetylations
                  <input type="checkbox" id="toggle_acet">
                  <span class="checkmark"></div>
                </label>
              </fieldset>
            </div>
          </div>

        </div>

        <div id="graph" class="col-sm-10">
          <!-- <div id="graph_title" style="margin-top:1em">{{ title }}</div> -->
          <div id=graph_box style="position:relative; height:600px">
            <div id="cy" class="cytoscape_container"></div>
            <script type="text/javascript">
              var graph_json = "{{ url_for('static',filename=graph_json) }}";
              var style_json = "{{ url_for('static',filename='js/cy_style.json') }}";
            </script>
            <script type="text/javascript" src="{{ url_for('static',filename='js/cyto_graph.js') }}"></script>

            <div id="quick-tools" class="col-sm-2">
              <div>
                <button class="btn" id="helpBtn" title="Help">
                  <i class="far fa-question-circle"></i>
                </button>
                <button class="btn" id="center" title="Center graph">
                  <i class="fa fa-align-center"></i>
                </button>
                <button class="btn" id="lock" title="Lock/unlock element positions">
                  <i class="fa fa-unlock"></i>
                </button>
                <button class="btn" id="reset" title="Reload graph">
                  <i class="fa fa-sync"></i>
                </button>
              </div>

              <div style="position: relative; padding-top: 5px;">
                <button class="btn" id="zoom_in" title="Zoom in">
                  <i class="fas fa-search-plus"></i>
                </button>
              </div>
              <div style="position: relative; padding-top: 5px;">
                <button class="btn" id="zoom_out" title="Zoom out">
                  <i class="fas fa-search-minus"></i>
                </button>
              </div>
            </div>
          </div>

          <div style="padding-top:5px; color: white;"> Download as
            <button class="btn" id="dl_json"><i class="fas fa-file-alt"></i> JSON </button>
            <button class="btn" id="dl_jpg"><i class="fas fa-image"></i> JPG </button>
            <button class="btn" id="dl_png"><i class="fas fa-image"></i> PNG </button>
            <button class="btn" id="dl_svg"><i class="fas fa-image"></i> SVG </button>
          </div>

          {% if not_identified|length > 0 %}
            <div style="padding-top:5px; color: orange;">
              The following could not be identified as proteins for the specified organism:
              <ul class="comma-list">
              {% for prot in not_identified %}
                <li><b>{{ prot }}</b></li>
              {% endfor %}
              </ul>
            </div>
          {% endif %}

          {% if no_int_prots|length > 0 %}
            <div style="padding-top:5px; color: white;">
              No interactions found for:
              <ul class="comma-list">
              {% for prot in no_int_prots %}
                <li><button class="txt-btn" onclick=showProt("{{ prot }}") title="Click to toggle protein"><b>{{ prot }}</b></button></li>
              {% endfor %}
              </ul>
            </div>
          {% endif %}
        </div>

        <div id="helpBox" class="modal">
          <div class="modal-content">
            <span class="close">&times;</span>
            <p><b>How to use:</b></p>
            <p>(soon™)</p>
            <p>Hovering over elements will change the color of connected nodes & edges.</p>
            <p>Clicking on nodes & edges triggers a pop-up box with information.</p>
            <p>Double-click within a protein box to quickly zoom in on it.</p>
          </div>
        </div>

      </div> <!--close main-->

      <br>
      <br>

      <div class="container-fluid">
        <div id="table_title">
          <span> List of interactions</span>
        </div>

        <br>

        <script type="text/javascript" src="static/js/interaction_table.js"></script>
        <script type="text/javascript">
          var ints_json ="{{ url_for('static',filename=ints_json) }}";
        </script>
        <table id="interactionTable" class="display">
      		<thead>
            <tr>
      				<th>Protein (A)</th>
              <th>Accession (A)</th>
      				<th>Protein (B)</th>
              <th>Accession (B)</th>
      				<th>Interaction<br>Type</th>
      				<th>F (A)</th>
              <th>Start-End (A)</th>
              <th>Mutations (A)</th>
      				<th>F (B)</th>
              <th>Start-End (B)</th>
              <th>Mutations (B)</th>
      				<th>Info</th>
              <th>Data<br>Source</th>
      			</tr>
      		</thead>
      		<tfoot>
      			<tr>
              <th>Protein (A)</th>
              <th>Accession (A)</th>
      				<th>Protein (B)</th>
              <th>Accession (B)</th>
      				<th>Interaction<br>Type</th>
              <th>F (A)</th>
              <th>Start-End  (A)</th>
              <th>Mutations (A)</th>
      				<th>F (B)</th>
              <th>Start-End (B)</th>
              <th>Mutations (B)</th>
      				<th>Info</th>
              <th>Data<br>Source</th>
      			</tr>
      		</tfoot>
      	</table>
      </div>

    </div>	<!--close main_container-->
    <br>
    <button onclick="topFunction()" id="goToTop"><i class="fas fa-level-up-alt"></i></button>

    <div id="footer">
  		<div class="row">
  			<div class="col-sm-5">
  				<div class="section">Developed by</div>
  				<p style="margin:0; padding:0;">
  					JC Gonzalez Sanchez, Mustafa Ibrahim, Kyle Weise and Rob Russell
  				</p>
  				<p>
  					at the <a href="http://www.russelllab.org/" style="color: white;">Russell Lab</a>
  					(University of Heidelberg, 2018)
  				</p>
  			</div>
  			<div class="col-sm-3">
  				<div class="section">Powered by</div>
  				<div id="cyto-logo">
  					<a href="http://js.cytoscape.org/">
  						<img src="{{ url_for('static',filename='images/cytoscape-logo-white.png') }}" alt="cyto-logo" width="35" height="40">Cytoscape.js
  					</a>
  				</div>
  			</div>
  			<div class="col-sm-4">
  				<div class="section">Contact</div>
  					<i style="color:white; margin-right:10px;" class="fas fa-envelope"></i>juan-carlos.gonzalez@bioquant.uni-heidelberg.de
  			</div>
  		</div>
  		<!-- <hr style="padding:0;">
  		<div><i>University of Heidelberg, 2018</i></div> -->
  	</div>
  </div>

  <script>
    ///// MODAL (Help pop-up)
    // Get the modal
    var modal = document.getElementById('helpBox');
    // Get the button that opens the modal
    var btn = document.getElementById("helpBtn");
    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName("close")[0];
    // When the user clicks the button, open the modal
    btn.onclick = function() {
      modal.style.display = "block";
    }
    // When the user clicks on <span> (x), close the modal
    span.onclick = function() {
      modal.style.display = "none";
    }
    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function(event) {
      if (event.target == modal) {
        modal.style.display = "none";
      }
    }

    ///// Go-to-Top Button
    // When the user scrolls down 20px from the top of the document, show the button
    window.onscroll = function() {scrollFunction()};

    function scrollFunction() {
      if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
        document.getElementById("goToTop").style.display = "block";
      } else {
        document.getElementById("goToTop").style.display = "none";
      }
    }
    // When the user clicks on the button, scroll to the top of the document
    function topFunction() {
      document.body.scrollTop = 0;
      document.documentElement.scrollTop = 0;
    }

  </script>

</body>
</html>
