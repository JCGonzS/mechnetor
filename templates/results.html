<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mechnetor</title>
  <link
    rel="shortcut icon"
    type="image/x-icon"
    href="static/images/mechnetor.ico"
  />
  <base target="_blank">
  <!--
    Loading Icon
  <script type="text/javascript" charset="utf8" src="https://raw.github.com/HubSpot/pace/v0.5.3/pace.min.js"></script>
  <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/pace_atom.css') }}">
  -->

  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Allerta+Stencil|Staatliches|Roboto:400|Merriweather:300,400|Audiowide|Lato">
  <link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/qtip2/3.0.3/jquery.qtip.min.css"/>
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/1.5.6/css/buttons.dataTables.min.css"/>
  <!-- <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/jquery.dataTables.css') }}"/> -->
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.min.css"/>
  <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/results_style.css') }}"/>
  <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/common.css') }}"/>

  <link rel="stylesheet" type="text/css" href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css/>
  <link rel="stylesheet" type="text/css" href=https://cdn.datatables.net/1.10.21/css/dataTables.bootstrap.min.css/>
  <link rel="stylesheet" type="text/css" href=https://cdn.datatables.net/fixedheader/3.1.7/css/fixedHeader.bootstrap.min.css/>
  <link rel="stylesheet" type="text/css" href=https://cdn.datatables.net/responsive/2.2.5/css/responsive.bootstrap.min.css/>


  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/qtip2/3.0.3/jquery.qtip.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.9.4/cytoscape.min.js" integrity="sha256-yvhiWj8VRHJV4JL+RmFcz3U2E2tu0bdjJ175tlvhSnE=" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://cdn.rawgit.com/cytoscape/cytoscape.js-qtip/2.7.1/cytoscape-qtip.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.min.js" integrity="sha256-FPJJt8nA+xL4RU6/gsriA8p8xAeLGatoyTjldvQKGdE=" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.2.0/jszip.min.js" integrity="sha256-VwkT6wiZwXUbi2b4BOR1i5hw43XMzVsP88kpesvRYfU=" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.57/pdfmake.min.js" integrity="sha256-8s2O+N1IIFZ/3uLADkpz++emTlVbAiI320n5vcyww8M=" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.57/vfs_fonts.js"></script>
  <script defer src="https://friconix.com/cdn/friconix.js"> </script> 
  <script type="text/javascript" src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/1.10.21/js/dataTables.bootstrap.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/fixedheader/3.1.7/js/dataTables.fixedHeader.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/responsive/2.2.5/js/dataTables.responsive.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/responsive/2.2.5/js/responsive.bootstrap.min.js "></script>

  <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.6/js/dataTables.buttons.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.colVis.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.flash.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.html5.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.print.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
  <script type="text/javascript" src="{{ url_for('static',filename='js/graph_features.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static',filename='js/echarts.min.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static',filename='js/stat_charts.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static',filename='js/cytoscape-svg.js') }}"></script>
  <script type="text/javascript">
    $(document).ready(function(){

      /// Modal (Help pop-up)
      var modal = document.getElementById("help-modal");
      // When the user clicks the button, open the modal
      $("#help-btn").click(function() {
        modal.style.display = "block";
      });
      // When the user clicks on (x), close the modal
      $("#help-modal-close").click(function() {
        modal.style.display = "none";
      });
      // When the user clicks anywhere outside of the modal, close it
      window.onclick = function(event) {
        if (event.target == modal) {
          modal.style.display = "none";
        }
      }
      
      var bookmark = document.getElementById("bookmark-msg")
      $("#bookmark-close").click(function() {
        bookmark.style.display = "none";
      });

      /// Download button
      $("#dl-content").hide();
      $("#dl-btn").click(function(){
        $("#dl-content").toggle();
      });


      /// Go-to-Top Button
      // When the user scrolls down 20px from the top of the document, show the button
      window.onscroll = function() {scrollFunction()};
      function scrollFunction() {
        if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
          $("#goToTop").show()
        } else {
          $("#goToTop").hide()
        }
      }
      // When the user clicks on the button, scroll to the top of the document
      function topFunction() {
        document.body.scrollTop = 0;
        document.documentElement.scrollTop = 0;
      }

    });
  </script>
  <script type="text/javascript">
      /// Import files
      var graph_json = "{{ url_for('static',filename=graph_json) }}";
      var style_json = "{{ url_for('static',filename='js/cy_style.json') }}";
      var ints_json ="{{ url_for('static',filename=ints_json) }}";
  </script>
  <script type="text/javascript" src="{{ url_for('static',filename='js/cyto_graph.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static',filename='js/interaction_table.js') }}" async></script>
  
</head>

<body>

  <div class="grid-container">

    {% include "header.html" %}

    <div class="content" >
      
      <div class="alert alert-info" id="bookmark-msg">
        Remember! Bookmark this page if you want to access your results later. 
        <span id='bookmark-close' style="cursor: pointer;"><strong> Got it</strong></span>
      </div>

      <div class="network-container">
        <div class="control-panel">

          <div>
            <fieldset>
                            <!-- <label class="container">Coord
                              <input type="checkbox" id="coord" checked="checked">
                              <span class="checkmark"></span>
                            </label><br> -->
              <label class="container">Protein Boxes
                <input type="checkbox" id="toggle_box" checked="checked">
                <span class="checkmark"></span>
              </label>
            </fieldset>
          </div>

          <hr>

          <div>
            <fieldset>
              <div>
                <span style="font-size: 14px; font-weight: bold;">Regions</span>
                <label class="container" style="display:inline;left: 10px;"> all
                  <input type="checkbox" id="toggle_all_ele">
                  <span class="checkmark"></span>
                </label>
              </div><br>

              <label class="container">Domains
                <input type="checkbox" id="toggle_doms" checked="checked">
                <span class="checkmark"></span>
              </label></br>
              <label class="container">Linear Motifs
                <input type="checkbox" id="toggle_elms">
                <span class="checkmark"></span>
              </label></br>
              <div id="elm_confirmed_container" style="float: right; display: none;">
                <label class="container">[Only confirmed]
                  <input type="checkbox" id="toggle_confirmed_elms">
                  <span class="checkmark"></span>
                </label></br>
              </div>
              <label class="container">3D-structure template
                <input type="checkbox" id="toggle_iprets">
                <span class="checkmark"></span>
              </label>
            </fieldset>
          </div>

          <hr>

          <div>
            <fieldset>
              <div>
                <span style="font-size: 14px; font-weight: bold;">Interactions</span>
                <label class="container" style="display:inline;left: 10px;"> all
                  <input type="checkbox" id="toggle_all_int">
                  <span class="checkmark"></span>
                </label>
              </div><br>
              <label class="container">Protein-Protein
                <input type="checkbox" id="toggle_pp_int" checked="checked">
                <span class="checkmark">
              </label></br>
              <label class="container"> Domain-Domain
                <input type="checkbox" id="toggle_dom_int">
                <span class="checkmark">
              </label></br>
              <label class="container">Domain-Domain (inferred)
                <input type="checkbox" id="toggle_idom_int">
                <span class="checkmark">
              </label>
              <div class="slidecontainer" id="lo_slider_container">
                LO >= <b><span id="lo_value"></span></b>
                <input type="range" min="2" max="10" value="2" class="slider" id="lo_slider" disabled>
              </div>
              <!-- <div class="slidecontainer">
                <p>P-value cut-off: P-val <= <b><span id="pval_value"></span></b></p>
                <input type="range" min="0" max="1" value="1" step="0.0001" class="slider" id="pval_slider">
              </div> -->

              <label class="container">Domain-LM (ELM)
                <input type="checkbox" id="toggle_elmdom_int">
                <span class="checkmark">
              </label></br>
              <label class="container">Domain-LM (3did)
                <input type="checkbox" id="toggle_dmi3d_int">
                <span class="checkmark">
              </label></br>
              <div id="confirmed_dmi3d_container" style="float: right; display: none;">
                <label class="container">[Only confirmed]
                  <input type="checkbox" id="confirmed_dmi3d_toggle">
                  <span class="checkmark"></span>
                </label></br>
              </div>
              <!-- <label class="container"><div style="color:##ff4d4d;"> ELM-Domain (inferred)
                <input type="checkbox" id="toggle_elmdom_pred_int">
                <span class="checkmark"></div>
              </label></br> -->
              <!-- <div class="form-check form-check-inline">
                <input class="form-check-input" type="checkbox" id="toggle_lmd2_int">
                <label class="form-check-label" for="toggle_lmd2_int"> LM(pred)-Protein (LMD2)</label>
              </div>
              </br> -->
              <label class="container">InterPreTS
                <input type="checkbox" id="toggle_prets_int">
                <span class="checkmark">
              </label>
              P-val <=<input type="number" id="pval_cutoff" min=0 max=1 value="0.75" step="0.0001">
            </fieldset>
          </div>

          <hr>

          <div>
            <fieldset>
              <div>
                <span style="font-size: 14px; font-weight: bold;">Modifications</span>
                <label class="container" style="display:inline;left: 10px;"> all
                  <input type="checkbox" id="toggle_all_mod">
                  <span class="checkmark"></span>
                </label>
              </div><br>

              <label class="container">User-input mutations
                <input type="checkbox" id="toggle_input_mut">
                <span class="checkmark">
              </label></br>
              <label class="container">Human cancer mutations
                <input type="checkbox" id="toggle_cosmic_mut">
                <span class="checkmark">
              </label></br>
              Sample >=<input type="number" id="sample_min" min=1 max=1000 value="2" step="1">
              <label class="container">Phosphorylations
                <input type="checkbox" id="toggle_phos">
                <span class="checkmark">
              </label></br>
              <label class="container">Acetylations
                <input type="checkbox" id="toggle_acet">
                <span class="checkmark">
              </label>
            </fieldset>
          </div>
          <hr>
          <div>
            <fieldset>
              <div>
                <span style="font-size: 14px; font-weight: bold;">UniProt features</span>
              </div><br>
              <label class="container"><div>UniProt REGION
                <input type="checkbox" id="toggle_uni_regions">
                <span class="checkmark"></div>
              </label></br>
              <label class="container"><div>UniProt VARIANT
                <input type="checkbox" id="toggle_uni_variants">
                <span class="checkmark"></div>
              </label></br>
              <label class="container"><div>UniProt MUTAGEN
                <input type="checkbox" id="toggle_uni_mutagen">
                <span class="checkmark"></div>
              </label></br>
              <label class="container"><div>UniProt BINDING
                <input type="checkbox" id="toggle_uni_binding">
                <span class="checkmark"></div>
              </label></br>
              <label class="container"><div>UniProt METAL
                <input type="checkbox" id="toggle_uni_metal">
                <span class="checkmark"></div>
              </label>
            </fieldset>
          </div>
        </div>

        <div class="network">

          <div class="cytoscape_container" id="cy"></div>


          <div class="tools-widget">
            <button class="my-btn" id="help-btn" title="Help">
              <i class="far fa-question-circle"></i>
            </button>
            <button class="my-btn" id="center" title="Center graph">
              <i class="fa fa-align-center"></i>
            </button>
            <button class="my-btn" id="lock" title="Lock/unlock element positions">
              <i class="fa fa-unlock"></i>
            </button>
            <button class="my-btn" id="reset" title="Reload graph">
              <i class="fa fa-sync"></i>
            </button>
          </div>
          
          <!-- <div class="help-widget">
            <button class="my-btn" id="help-btn" title="Help">
              <i class="far fa-question-circle"></i>
            </button>
          </div> -->

          <div class="zoom-widget">
            <div class="zoom-widget-row">
              <button class="my-btn" id="zoom_in" title="Zoom in">
                <i class="fas fa-search-plus"></i>
              </button>
            </div>
            <div class="zoom-widget-row">
              <button class="my-btn" id="zoom_out" title="Zoom out">
                <i class="fas fa-search-minus"></i>
              </button>
            </div>
          </div>

          <div class="dl-widget">
            <button class="my-btn" id="dl-btn">
              <!-- <i class="fas fa-save"></i> -->
              <i class="fas fa-camera"></i>
            </button>
            <div id="dl-content"> 
              <!-- <i class="far fa-file-image" style="font-size: 20px; vertical-align: middle;"></i> -->
              <span style="font-weight: 500;"> Download snapshot as:   </span>
              <!-- <button class="btn" id="dl_json"><i class="fas fa-file-alt"></i> JSON </button> -->
              <button class="dl-btn-pic" id="dl_jpg"><i class="far fa-file-image"></i> JPG </button>
              <button class="dl-btn-pic" id="dl_png"><i class="far fa-file-image"></i> PNG </button>
              <button class="dl-btn-pic" id="dl_svg"><i class="far fa-file-image"></i> SVG </button>
            </div>
          </div>
        </div>

        <div class="modal" id="help-modal">
          <div class="modal-content">
            <span style="padding-right: 3px; background-color: #e44445;" class="modal-close" id="help-modal-close">&times;</span>
            <h4 style="padding: 3px; background-color: #e44445; color: white;">
              <b>Quick Guide</b>
            </h4>
            <ul style="list-style: none;">
              <li>
                <i class="fas fa-arrows-alt" style="font-size:x-large;"></i> 
                <b>Move</b> proteins around by clicking and dragging them.
              </li>
              <li>
                <i class="fas fa-search-plus" style="font-size:x-large;"></i>
                <b>Zoom</b> in and out with your mouse wheel. Quickly zoom to a protein by double-clicking on it.
              </li>
              <li>
                <i class="fas fa-hand-pointer" style="font-size:x-large;"></i>
                <b>Hover</b> over elements to highlight connected nodes and edges, and to show their labels.
              </li>
              <li>
                <i class="fas fa-comment-alt" style="font-size:x-large;"></i>
                <b>Click</b> on nodes and edges to display boxes with more information.
              </li>
              <li>
                <i class="fas fa-check-square" style="font-size:x-large;"></i>
                <b>Toggle</b> on or off the different protein elements and interactions using the toolbox on the left.
              </li>
            </ul>
          </div>
        </div>

      </div>

      <div class="extra-info-container">

        {% if not_found|length > 0 %}
          <div>
            The following could not be identified as proteins for the specified organism:
            <ul class="comma-list">
            {% for prot in not_found %}
              <li><b>{{ prot }}</b></li>
            {% endfor %}
            </ul>
          </div>
        {% endif %}

        {% if no_int_prots|length > 0 %}
          <div style="padding-top:5px;">
            No interactions found for:
            <ul class="comma-list">
            {% for prot in no_int_prots %}
              <li><button class="txt-btn" onclick=showProt("{{ prot }}") title="Click to toggle protein"><b>{{ prot }}</b></button></li>
            {% endfor %}
            </ul>
          </div>
        {% endif %}

      </div>

      <!-- <div class="container-fluid">
        <h2><span><i class="far fa-chart-bar"></i> General Stats</span></h2>
        <div style="width:100%; padding:5px;" class="row">
            <div id="prot-barplot" class="echart"></div>
            <div id="inttype-barplot" class="echart"></div>
        </div>
        <div style="width:100%; padding:5px;" class="row">
            <div id="dom-barplot" class="echart"></div>
            <div id="dom-barplot2" class="echart"></div>
        </div>

        <script type="text/javascript">

          $(document).ready(function(){
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.open("GET", "{{ url_for('static',filename=stats_json) }}", true);
            xmlhttp.onreadystatechange = function() {
              if (this.readyState == 4 && this.status == 200) {
                var stats = JSON.parse(this.responseText);
                var proteins = stats.prot_ints_k;
                var interactors = stats.prot_ints_v;
                var max_ints_per_protein = proteins.length - 1;
                var max_ppi = stats.max_ppi;
                var int_types = stats.int_types_k;
                var int_types_series = stats.int_types_series;
                var domains = stats.dom_ints_k;
                var dom_ints = stats.dom_ints;
                makeProtBarplot("prot-barplot", proteins, interactors, max_ints_per_protein);
                makeIntTypeBarplot("inttype-barplot", int_types, int_types_series, max_ppi)
                makeDomBarplot("dom-barplot", domains, dom_ints.total, max_ints_per_protein);
                makeDomBarplot2("dom-barplot2", domains, dom_ints, max_ints_per_protein);
              }
            };
            xmlhttp.send();


          });
        </script>
      </div>

      <br>-->

      <div class="section-header"><i class="fas fa-list"></i> Interaction Evidence List</div>
      <div class="interaction-table-container">
        <!-- <table id="interaction-table" style="width:98% !important; table-layout:fixed;"> -->
        <table id="interaction-table" class="table table-striped table-bordered">
      		<thead>
            <tr>
              {% if table_columns|length > 0 %}
                {% for col in table_columns %}
                  <th>{{ col }}</th>
                {% endfor %}
              {% endif %}
            </tr>
      		</thead>
      		<tfoot>
            <tr>
              {% if table_columns|length > 0 %}
                {% for col in table_columns %}
                  <th>{{ col }}</th>
                {% endfor %}
              {% endif %}
            </tr>
          </tfoot>
      	</table>
      </div>
      
      <button onclick="topFunction()" id="goToTop"><i class="fas fa-level-up-alt"></i></button>
    </div>

    {% include "footer.html" %}

  </div>



</body>
</html>
